<header class="header">
  <div class="header-content">
    <a routerLink="/" class="logo" aria-label="Go to home">
      <span class="logo-mark" aria-hidden="true">E</span>
      <span class="logo-text">E-Commerce</span>
    </a>
    
    <button 
      class="mobile-menu-btn" 
      type="button" 
      (click)="toggleMobileMenu()"
      [attr.aria-expanded]="mobileMenuOpen"
      aria-label="Toggle menu"
      aria-controls="mobile-menu">
      <span class="hamburger" [class.active]="mobileMenuOpen">
        <span></span>
        <span></span>
        <span></span>
      </span>
    </button>

    <div class="search">
      <input
        class="search-input"
        type="text"
        [(ngModel)]="searchQuery"
        (keyup.enter)="onSearch()"
        placeholder="Search products..."
        aria-label="Search products"
      />
      <button class="btn btn-ghost search-btn" type="button" (click)="onSearch()" aria-label="Search">
        <span aria-hidden="true">âŒ•</span>
      </button>
    </div>

    @if (mobileMenuOpen) {
      <div class="mobile-menu-backdrop" (click)="closeMobileMenu()" aria-hidden="true"></div>
    }

    <nav class="nav" [class.mobile-open]="mobileMenuOpen" id="mobile-menu">
      <a routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{ exact: true }" (click)="closeMobileMenu()">Home</a>
      <a routerLink="/products" routerLinkActive="active" (click)="closeMobileMenu()">Products</a>
      <a routerLink="/cart" routerLinkActive="active" (click)="closeMobileMenu()">Cart</a>
      @if (isSeller()) {
        <a routerLink="/seller" routerLinkActive="active" (click)="closeMobileMenu()">Seller</a>
      }
      @if (isAuthenticated()) {
        <a routerLink="/orders" (click)="closeMobileMenu()">My Orders</a>
        <button class="menu-item danger" type="button" (click)="logout(); closeMobileMenu()">Logout</button>
      }
    </nav>

    <div class="actions">
      @if (isAuthenticated()) {
        <div class="user">
          <button type="button" class="icon-btn" (click)="toggleUserMenu()" aria-label="Open user menu">
            <span class="icon" aria-hidden="true">ðŸ‘¤</span>
          </button>
          @if (userMenuOpen) {
            <div class="menu" (mouseleave)="closeUserMenu()">
              <div class="menu-header">
                <div class="menu-name">{{ currentUser()?.firstName }} {{ currentUser()?.lastName }}</div>
                <div class="menu-email">{{ currentUser()?.email }}</div>
              </div>
              <div class="menu-sep"></div>
              <a class="menu-item" routerLink="/orders" (click)="closeUserMenu()">My Orders</a>
              <button class="menu-item danger" type="button" (click)="logout()">Logout</button>
            </div>
          }
        </div>
      } @else {
        <a class="btn btn-ghost" routerLink="/auth/login">Login</a>
        <a class="btn btn-primary" routerLink="/auth/register">Sign Up</a>
      }
      
      
    </div>
  </div>
</header>
